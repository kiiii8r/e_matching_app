<%= render "shared/contents-header" %>

<div class ='main-contents'>

  <div class='main'>
    <div class='search-contents'>

       <h2 class='search-title'>Search</h2>

       <%= search_form_for @search do |f| %>

        <div class='search-lists'>
          <h3 class='search-name'>◆名前で検索</h3>

          <%= f.label :nickname_cont, 'ユーザー名' %>
          <%= f.text_field :nickname_cont %>

          <div class='search-btn'>
            <%= f.submit '検索' %>
          </div>
        </div>

      <% end %>

      <%= search_form_for @p, url: users_search_path do |f| %>

        <div class='search-lists'>
          <h3 class='search-name'>◆絞り込みで検索</h3>

          <%= f.label :gender_eq, '性別：' %>
          <%= f.collection_select :gender_eq, @user_gender, :gender, :gender,  include_blank: '指定なし' %>

          <br>

          <%= f.label :profile_role_id_eq, '役割：' %>
          <%= f.collection_select(:profile_role_id_eq, Role.all, :id, :name, { include_blank: '指定なし' }, {class:"select-box", id:"role"}) %>

          <br>

          <%= f.label :profile_language1_id_eq, '主用言語：' %>
          <%= f.collection_select(:profile_language_id_eq, Language.all, :id, :name, { include_blank: '指定なし'  }, {class:"select-box", id:"language1"}) %>

          <br>

          <%= f.label :profile_prefecture_id_eq, '都道府県：' %>
          <%= f.collection_select(:profile_prefecture_id_eq, Prefecture.all, :id, :name, { include_blank: '指定なし' }, {class:"select-box", id:"prefecture"}) %>

          <br>

          <div class='search-btn'>
            <%= f.submit '検索' %>
          </div>
        </div>

      <% end %>

    </div>

    <div class='user-contents'>
      <h2 class='title'>User list</h2>

      <ul class='user-list'>

        <% if @results.length !=0 %>

          <% @results.each do |result| %>

            <% unless current_user.id == result.id %>

              <li class='list'>

                <%= link_to user_path(result.id) do %>

                  <div class='user-img-content'>

                    <%if result.profile.image.present? %>

                       <%= image_tag result.profile.image.variant(gravity: :center, resize:"250x250^", crop:"250x250+0+0"), class: "user-img" if result.profile.image.attached? %>

                    <% elsif result.gender == "male" %>

                      <%= image_tag 'mens_silhouette.png', size: "250x250", class: "user-img" %>

                    <% else %>

                      <%= image_tag 'radies_silhouette.png', size: "250x250", class: "user-img" %>

                    <% end %>

                  </div>

                  <div class='user-info'>

                    <div class='user-title'>
                      <h3 class='user-name'><%= result.nickname %></h3>
                      <div class='user-age'><%= result.age %>歳</div>
                    </div>

                     <div class='detail-lists'>
                    <div class='detail-title'>
                      <div class='user-language'>主用言語</div>
                      <%= result.profile.language.name %>
                    </div>

                    <div class='detail-title'>
                      <div class='user-role'>主な役割</div>
                      <%= result.profile.role.name %>
                    </div>
                  </div>


                    <div class='star-btn'>
                      <%# <%= image_tag "star.png", class:"star-icon" %> 
                      <span class='star-count'></span>
                    </div>
                  </div>

                <% end %>

              </li>

            <% end %>

          <% end %>

        <% else %>

          <div class='no-users'>該当するユーザーは存在しませんでした。</div>

        <% end %>

      </ul>
    </div>
  </div>
</div>

<%= render "shared/contents-footer" %>