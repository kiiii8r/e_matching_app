<%= render "shared/contents-header" %>

<h1>
  ユーザー検索
</h1>

<%= search_form_for @search do |f| %>
  <%= f.label :nickname_cont, 'ユーザー名' %>
  <%= f.text_field :nickname_cont %>
  <div>
    <%= f.submit '名前で検索' %>
  </div>
<% end %>

<%= search_form_for @p, url: users_search_path do |f| %>
  <%= f.label :gender_eq, '性別：' %>
  <%= f.collection_select :gender_eq, @user_gender, :gender, :gender,  include_blank: '指定なし' %>
  <br>
  <%= f.label :profile_role_id_eq, '役割：' %>
  <%= f.collection_select(:profile_role_id_eq, Role.all, :id, :name, { include_blank: '指定なし' }, {class:"select-box", id:"role"}) %>
    <br>

  <%= f.label :profile_language1_id_eq, '主な使用言語：' %>
  <%= f.collection_select(:profile_language1_id_eq, Language1.all, :id, :name, { include_blank: '指定なし' }, {class:"select-box", id:"language1"}) %>

  <%= f.label :profile_prefecture_id_eq, '都道府県：' %>
  <%= f.collection_select(:profile_prefecture_id_eq, Prefecture.all, :id, :name, { include_blank: '指定なし' }, {class:"select-box", id:"prefecture"}) %>
    <br>
  <%= f.submit '絞り込みで検索' %>
<% end %>

 <div class='user-contents'>
    <h2 class='title'>ユーザー一覧</h2>
    <ul class='user-lists'>


<% if @results.length !=0 %>
  <% @results.each do |result| %>
  <% unless current_user.id == result.id%>

      <li class='list'>
        <%= link_to user_path(result.id) do %>
        <div class='user-img-content'>

        <%if result.profile.image.present? %>

          <%= image_tag result.profile.image.variant(resize:'300x300'), class: "user-img" if result.profile.image.attached? %>

        <% elsif result.gender == "male" %>

           <%= image_tag 'mens_silhouette.png', size: "300x300", class: "user-img" %>

        <% else %>

           <%= image_tag 'radies_silhouette.png', size: "300x300", class: "user-img" %>

        <% end %>

        </div>
        <div class='user-info'>
          <h3 class='user-name'>
            <%= result.nickname %>
          </h3>
          <div class='user-language'>
            <span><%= result.profile.language1.name %>言語</span>
            <span><%= result.profile.language2.name %>言語</span>
            <span><%= result.profile.language3.name %>言語</span>
          </div>
            <div class='user-role'>
            <%= result.profile.role.name %>
            </div>
            <div class='star-btn'>
              <%# <%= image_tag "star.png", class:"star-icon" %> %>
              <span class='star-count'>0</span>
            </div>
          </div>
        </div>
        <% end %>
      </li>

        <% end %>
  <% end %>
<% else %>
  該当するユーザーは存在しませんでした。
<% end %>
<br>

<%= render "shared/contents-footer" %>